import frappe, erpnext

from frappe import _

def get_level():
    activation_level = 0
    if frappe.db.get_single_value('System Settings', 'setup_complete'):
    activation_level = 1

    if frappe.db.count('Patient') > 5:
    activation_level += 1

    # recent login
    if frappe.db.sql('select name from tabUser where last_login > date_sub(now(), interval 2 day) limit 1'):
    activation_level += 1

    return activation_level

def get_help_messages():
    '''Returns help messages to be shown on Desktop'''
    if get_level() > 3:
        return []

    messages = []

    domain = frappe.db.get_value('Company', erpnext.get_default_company(), 'domain')

    message_settings = [
        frappe._dict(
            doctype='Patient',
            title=_('Create Patients'),
            description=_('Add your first patients to the system'),
            action=_('Add Patient'),
            route='List/Patient',
            domain=('Midwife'),
            target=5
        )
