// Copyright (c) 2017, DOKOS and contributors
// For license information, please see license.txt

frappe.provide('maia');

frappe.ui.form.on('Perineum Rehabilitation', {
    refresh: function(frm) {
	cur_frm.toggle_display("patient_name",
			       (cur_frm.doc.patient_name && cur_frm.doc.patient_name!==cur_frm.doc.patient));	

	cur_frm.add_fetch('patient', 'patient_name', 'patient_name');
	
    }   

	
});

maia.PatientController = frappe.ui.form.Controller.extend({
    refresh: function() {
	cur_frm.add_custom_button(__("Consultation"), this.create_consultation, __("Make"));
	cur_frm.page.set_inner_btn_group_as_primary(__("Make"));

    },
	
    create_consultation: function() {
	   frappe.model.open_mapped_doc({
		method: "maia.maia.doctype.perineum_rehabilitation.perineum_rehabilitation.make_consultation",
		frm: cur_frm
	   })
    }

});

$.extend(cur_frm.cscript, new maia.PatientController({frm: cur_frm}));

